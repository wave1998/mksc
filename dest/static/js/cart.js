function loadPage(){for(var t=JSON.parse(localStorage.getItem("list")),e="",c=0;c<t.length;c++)e+='\n        <tr>\n            <td><input type="checkbox"  class="checkOne"></td>\n            <td>\n                <img src="'+t[c].image+'" width="100" height="100">\n                <h5>'+t[c].name+'</h5>\n            </td>\n            <td>\n                ￥<span class="price">'+t[c].price+'</span>\n            </td>\n            <td>\n                <div class="number clear_fix">\n                    <input type="button" value="-" class="cut">\n                    <input type="number" class="num" value="'+t[c].number+'">\n                    <input type="button" value="+" class="add">\n                    <input type="hidden" name="stock" value="'+t[c].stock+'">\n                </div>\n            </td>\n            <td>\n                    ￥<span class="subtotal">'+(t[c].price*t[c].number).toFixed(2)+'</span>\n            </td>\n            <td>\n                <button data-id="'+t[c].id+'" class="del">删除</button>\n            </td>\n        </tr>\n        ';$(".cart_tbody").html(e),bindClick()}function bindClick(){$(".del").click(function(){console.log(this);for(var t,e=JSON.parse(localStorage.getItem("list")),c=$(this).attr("data-id"),n=0;n<e.length;n++)e[n].id==c&&(t=n);e.splice(t,1),localStorage.setItem("list",JSON.stringify(e)),loadPage(),cartSum()})}function subtotal(){$(".subtotal").each(function(){var t=$(this).parent().prev().children().find(".num").val()-0,e=$(this).parent().siblings().find(".price").text()-0;$(this).text((t*e).toFixed(2))})}function countTotal(){var c=0,n=0;$(".checkOne:checked").each(function(t,e){c+=$(e).parent().siblings().find(".number").children(".num").val()-0,n+=$(e).parent().siblings().children(".subtotal").text()-0}),$(".total b i").text(c),$(".total b em").text(n.toFixed(2))}function cartSum(){var c=0;$(".num").each(function(t,e){c=$(e).val()-0}),localStorage.setItem("cart_counts",""+c),$(".cart_counts").text(localStorage.getItem("cart_counts"))}loadPage(),$(".number").click(function(t){var e,c=t.target;"cut"==c.className&&(e=(e=$(c).next().val()-0-1)<=1?1:$(c).next().val()-0-1,$(c).next().val(e));"add"==c.className&&(e=(e=$(c).prev().val()-0+1)>=$(c).next().val()-0?$(c).next().val()-0:$(c).prev().val()-0+1,$(c).prev().val(e));subtotal(),countTotal(),cartSum()}),$(".checkAll").click(function(){$(this).prop("checked")?($(".checkOne").prop("checked",!0),$(".checkAll").prop("checked",!0)):($(".checkOne").prop("checked",!1),$(".checkAll").prop("checked",!1)),countTotal()}),$(".checkOne").click(function(){Array.prototype.slice.call($(".checkOne")).every(function(t){if($(t).prop("checked"))return!0})?$(".checkAll").prop("checked",!0):$(".checkAll").prop("checked",!1),countTotal()}),$(".cart_counts").text(localStorage.getItem("cart_counts"));